SELECT 
    dc.DIM_E_SGEH_HIER321_CELL.HIER3_ID as HIER3_ID,     
    dc.DIM_E_SGEH_HIER321_CELL.HIER321_ID as HIER321_ID, 
    dc.DIM_E_SGEH_HIER321_CELL.HIER3_CELL_ID as HIER3_CELL_ID,
    dc.DIM_E_SGEH_HIER321_CELL.CELL_ID as CELL_ID,     
    dc.DIM_E_RAN_RNCFUNCTION.rncId as RNC_ID,
    dc.DIM_E_SGEH_HIER321_CELL.CID as C_ID,
    (dc.DIM_E_SGEH_MCCMNC.MCC || dc.DIM_E_SGEH_MCCMNC.MNC) as PLMN_ID,
    dc.DIM_E_SGEH_MCCMNC.MCC as MCC,
    dc.DIM_E_SGEH_MCCMNC.MNC as MNC,
    dc.DIM_E_SGEH_HIER321.LAC as LAC,
    dc.DIM_E_SGEH_HIER321.RAT as RAT,
    dc.DIM_E_SGEH_HIER321.RAC as RAC
FROM 
    dc.DIM_E_SGEH_HIER321, 
    dc.DIM_E_SGEH_HIER321_CELL, 
    dc.DIM_E_RAN_RNC, 
    dc.DIM_E_RAN_RNCFUNCTION,
    dc.DIM_E_SGEH_MCCMNC
WHERE 
    dc.DIM_E_SGEH_HIER321.HIER321_ID      = dc.DIM_E_SGEH_HIER321_CELL.HIER321_ID 
    AND dc.DIM_E_SGEH_HIER321.HIERARCHY_3 = dc.DIM_E_RAN_RNC.ALTERNATIVE_FDN 
    AND dc.DIM_E_RAN_RNC.RNC_FDN          = dc.DIM_E_RAN_RNCFUNCTION.SN 
    AND dc.DIM_E_RAN_RNCFUNCTION.rncId is not null
    AND dc.DIM_E_SGEH_HIER321_CELL.CID is not null
    AND dc.DIM_E_SGEH_MCCMNC.MCC = dc.DIM_E_SGEH_HIER321.MCC
    AND (dc.DIM_E_SGEH_HIER321.MNC = dc.DIM_E_SGEH_MCCMNC.MNC OR '0' || dc.DIM_E_SGEH_HIER321.MNC = dc.DIM_E_SGEH_MCCMNC.MNC)
     AND dc.DIM_E_SGEH_HIER321.MODIFIED > $lastUpdateTime
UNION

SELECT
    dc.DIM_E_SGEH_HIER321.HIER3_ID as HIER3_ID,
    dc.DIM_E_SGEH_HIER321.HIER321_ID as HIER321_ID,
    null as HIER3_CELL_ID,
    null as CELL_ID,
    -1 as RNC_ID,    
    dc.DIM_E_SGEH_HIER321.ACCESS_AREA_ID as C_ID,
    (dc.DIM_E_SGEH_MCCMNC.MCC || dc.DIM_E_SGEH_MCCMNC.MNC) as PLMN_ID,
    dc.DIM_E_SGEH_MCCMNC.MCC as MCC,
    dc.DIM_E_SGEH_MCCMNC.MNC as MNC,
    dc.DIM_E_SGEH_HIER321.LAC as LAC,
    dc.DIM_E_SGEH_HIER321.RAT as RAT,
    dc.DIM_E_SGEH_HIER321.RAC as RAC
FROM
    dc.DIM_E_SGEH_HIER321,
    dc.DIM_E_SGEH_MCCMNC
WHERE
     dc.DIM_E_SGEH_HIER321.RAT = 0     
     AND dc.DIM_E_SGEH_HIER321.ACCESS_AREA_ID is not null
     AND dc.DIM_E_SGEH_HIER321.LAC is not null 
     AND dc.DIM_E_SGEH_MCCMNC.MCC = dc.DIM_E_SGEH_HIER321.MCC
     AND (dc.DIM_E_SGEH_HIER321.MNC = dc.DIM_E_SGEH_MCCMNC.MNC OR '0' || dc.DIM_E_SGEH_HIER321.MNC = dc.DIM_E_SGEH_MCCMNC.MNC)
      AND dc.DIM_E_SGEH_HIER321.MODIFIED > $lastUpdateTime    
UNION

SELECT
    dc.DIM_Z_SGEH_HIER321.HIER3_ID as HIER3_ID,
    dc.DIM_Z_SGEH_HIER321.HIER321_ID as HIER321_ID,
    dc.DIM_Z_SGEH_HIER321_CELL.HIER3_CELL_ID as HIER3_CELL_ID,
    dc.DIM_Z_SGEH_HIER321_CELL.CELL_ID as CELL_ID,
    -1 as RNC_ID,
    dc.DIM_Z_SGEH_HIER321_CELL.CID as C_ID,
    (dc.DIM_E_SGEH_MCCMNC.MCC || dc.DIM_E_SGEH_MCCMNC.MNC) as PLMN_ID,
    dc.DIM_E_SGEH_MCCMNC.MCC as MCC,
    dc.DIM_E_SGEH_MCCMNC.MNC as MNC,
    dc.DIM_Z_SGEH_HIER321.LAC as LAC,
    dc.DIM_Z_SGEH_HIER321.RAT as RAT,
    dc.DIM_Z_SGEH_HIER321.RAC as RAC
FROM
    dc.DIM_Z_SGEH_HIER321,
    dc.DIM_Z_SGEH_HIER321_CELL,
    dc.DIM_E_SGEH_MCCMNC
WHERE
    dc.DIM_Z_SGEH_HIER321.HIER321_ID = dc.DIM_Z_SGEH_HIER321_CELL.HIER321_ID
    and dc.DIM_Z_SGEH_HIER321_CELL.CID is not null
    and dc.DIM_Z_SGEH_HIER321.LAC is not null  
    AND dc.DIM_E_SGEH_MCCMNC.MCC = dc.DIM_Z_SGEH_HIER321.MCC
    AND (dc.DIM_Z_SGEH_HIER321.MNC = dc.DIM_E_SGEH_MCCMNC.MNC OR '0' || dc.DIM_Z_SGEH_HIER321.MNC = dc.DIM_E_SGEH_MCCMNC.MNC)
     AND dc.DIM_Z_SGEH_HIER321.MODIFIED > $lastUpdateTime     
UNION

SELECT
    dc.DIM_Z_SGEH_HIER321.HIER3_ID as HIER3_ID,
    dc.DIM_Z_SGEH_HIER321.HIER321_ID as HIER321_ID,
    null as HIER3_CELL_ID,
    null as CELL_ID,
    -1 as RNC_ID,   
    dc.DIM_Z_SGEH_HIER321.ACCESS_AREA_ID as C_ID,
    (dc.DIM_E_SGEH_MCCMNC.MCC || dc.DIM_E_SGEH_MCCMNC.MNC) as PLMN_ID,
    dc.DIM_E_SGEH_MCCMNC.MCC as MCC,
    dc.DIM_E_SGEH_MCCMNC.MNC as MNC,
    dc.DIM_Z_SGEH_HIER321.LAC as LAC,
    dc.DIM_Z_SGEH_HIER321.RAT as RAT,
    dc.DIM_Z_SGEH_HIER321.RAC as RAC
FROM
    dc.DIM_Z_SGEH_HIER321,
    dc.DIM_E_SGEH_MCCMNC
WHERE
     dc.DIM_Z_SGEH_HIER321.RAT = 0     
     AND dc.DIM_Z_SGEH_HIER321.ACCESS_AREA_ID is not null
     AND dc.DIM_Z_SGEH_HIER321.LAC is not null 
     AND dc.DIM_E_SGEH_MCCMNC.MCC = dc.DIM_Z_SGEH_HIER321.MCC
     AND (dc.DIM_Z_SGEH_HIER321.MNC = dc.DIM_E_SGEH_MCCMNC.MNC OR '0' || dc.DIM_Z_SGEH_HIER321.MNC = dc.DIM_E_SGEH_MCCMNC.MNC)
      AND dc.DIM_Z_SGEH_HIER321.MODIFIED > $lastUpdateTime